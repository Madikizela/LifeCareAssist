@page
@model RuralHealthcare.Web.Pages.HealthWorker.HealthWorkerDashboardModel
@{
    ViewData["Title"] = "Health Worker Dashboard";
}

<h1 class="text-3xl font-bold mb-6">Health Worker Dashboard</h1>

<div class="grid grid-cols-1 md:grid-cols-4 gap-6">
    <div class="card">
        <div class="p-6">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-lg font-semibold">Clinic Patients</h3>
                <span class="text-2xl">ðŸ‘¥</span>
            </div>
            <p class="text-4xl font-bold mt-2">@Model.ClinicPatients</p>
            <a href="/patients" class="mt-3 inline-flex items-center gap-2 px-3 py-2 rounded bg-blue-600 text-white">View Patients</a>
        </div>
    </div>
    <div class="card">
        <div class="p-6">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-lg font-semibold">Today Appointments</h3>
                <span class="text-2xl">ðŸ“…</span>
            </div>
            <p class="text-4xl font-bold mt-2">@Model.TodayAppointmentsCount</p>
            <a href="/appointments?filter=today" class="mt-3 inline-flex items-center gap-2 px-3 py-2 rounded bg-blue-600 text-white">View Today</a>
        </div>
    </div>
    <div class="card">
        <div class="p-6">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-lg font-semibold">Active Emergencies</h3>
                <span class="text-2xl">ðŸš¨</span>
            </div>
            <p class="text-4xl font-bold mt-2">@Model.ActiveEmergenciesCount</p>
            <a href="/emergency" class="mt-3 inline-flex items-center gap-2 px-3 py-2 rounded bg-blue-600 text-white">View Emergencies</a>
        </div>
    </div>
    <div class="card">
        <div class="p-6">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-lg font-semibold">Quick Actions</h3>
                <span class="text-2xl">âš¡</span>
            </div>
            <div class="grid grid-cols-1 gap-2">
                <a href="/emergency/create" class="btn btn-primary">Create Emergency</a>
                <a href="/find-medication" class="btn btn-secondary">Find Medication</a>
                <a href="/appointments/create" class="btn bg-blue-100 text-blue-800 hover:bg-blue-200">Schedule Appointment</a>
            </div>
        </div>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
    <div class="card">
        <div class="p-6">
            <h2 class="text-xl font-bold mb-4">Todayâ€™s Appointments</h2>
            @if (Model.TodayAppointments.Any())
            {
                <ul class="divide-y">
                    @foreach (var a in Model.TodayAppointments)
                    {
                        <li class="py-3 flex items-center justify-between">
                            <div>
                                <div class="font-semibold">@a.Patient.FirstName @a.Patient.LastName</div>
                                <div class="text-sm text-gray-600">@a.ScheduledDateTime.ToString("HH:mm") â€¢ @a.AppointmentType</div>
                            </div>
                            <span class="px-3 py-1 rounded-full text-sm font-semibold @(a.Status == "scheduled" ? "bg-blue-100 text-blue-800" : (a.Status == "completed" ? "bg-green-100 text-green-800" : (a.Status == "missed" ? "bg-red-100 text-red-800" : "bg-gray-100 text-gray-800")))">@a.Status</span>
                        </li>
                    }
                </ul>
            }
            else
            {
                <div class="text-gray-600">No appointments scheduled for today.</div>
            }
        </div>
    </div>

    <div class="card">
        <div class="p-6">
            <h2 class="text-xl font-bold mb-4">Active Emergencies</h2>
            @if (Model.ActiveEmergencies.Any())
            {
                <ul class="divide-y">
                    @foreach (var e in Model.ActiveEmergencies)
                    {
                        <li class="py-3">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">@e.EmergencyType.ToUpper() â€¢ @e.CallTime.ToString("HH:mm")</div>
                                    <div class="text-sm text-gray-600">@((e.Patient != null) ? ($"{e.Patient.FirstName} {e.Patient.LastName}") : "Anonymous")</div>
                                </div>
                                <span class="px-3 py-1 rounded-full text-sm font-semibold @(e.Status == "pending" ? "bg-yellow-100 text-yellow-800" : (e.Status == "dispatched" ? "bg-blue-100 text-blue-800" : "bg-gray-100 text-gray-800"))">@e.Status</span>
                            </div>
                        </li>
                    }
                </ul>
            }
            else
            {
                <div class="text-gray-600">No active emergencies.</div>
            }
        </div>
    </div>
</div>

